# ç»Ÿä¸€äº‹ä»¶é©±åŠ¨æ¶æ„é‡æ„è¿ç§»è·¯çº¿å›¾

## 1. æ‰§è¡Œæ‘˜è¦

æœ¬æ–‡æ¡£æä¾›äº†å°†å½“å‰ç³»ç»Ÿé‡æ„ä¸ºç»Ÿä¸€äº‹ä»¶é©±åŠ¨æ¶æ„çš„è¯¦ç»†è¿ç§»è·¯çº¿å›¾ã€‚ç›®æ ‡æ˜¯é€šè¿‡åˆ†é˜¶æ®µå®æ–½ï¼Œä½¿å›æµ‹æµç¨‹å’Œå®ç›˜äº¤æ˜“æµç¨‹åŸºæœ¬ä¸€è‡´ï¼Œæé«˜ä»£ç å¤ç”¨ç‡ï¼Œå‡å°‘å‰è§†åå·®ï¼Œå¹¶æå‡ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§å’Œå¯é æ€§ã€‚

## 2. å½“å‰ç³»ç»Ÿè¯„ä¼°

### 2.1 ä»£ç è§„æ¨¡ç»Ÿè®¡

| ç»„ä»¶ | æ–‡ä»¶æ•° | ä»£ç è¡Œæ•°(ä¼°ç®—) | å¤æ‚åº¦ |
|------|--------|----------------|--------|
| å›æµ‹å¼•æ“ | 8 | 2,500 | é«˜ |
| ç­–ç•¥ç³»ç»Ÿ | 12 | 3,000 | ä¸­é«˜ |
| æ•°æ®ç®¡ç† | 15 | 4,000 | é«˜ |
| æ‰§è¡Œå¼•æ“ | 8 | 2,000 | ä¸­ |
| äº‹ä»¶å¼•æ“ | 1 | 200 | ä½ |
| å·¥å…·ç±» | 20 | 3,000 | ä¸­ |
| **æ€»è®¡** | **64** | **14,700** | - |

### 2.2 å…³é”®æŠ€æœ¯å€ºåŠ¡

1. **æ¶æ„é—®é¢˜**
   - å›æµ‹å’Œå®ç›˜ä½¿ç”¨å®Œå…¨ä¸åŒçš„ä»£ç è·¯å¾„
   - äº‹ä»¶å¼•æ“å­˜åœ¨ä½†æœªè¢«å›æµ‹ç³»ç»Ÿä½¿ç”¨
   - ç¼ºä¹ç»Ÿä¸€çš„çŠ¶æ€ç®¡ç†

2. **ä»£ç é—®é¢˜**
   - å­˜åœ¨å…¨å±€å˜é‡å’Œå•ä¾‹æ¨¡å¼
   - ç±»å‹æ³¨è§£ä¸å®Œæ•´
   - é”™è¯¯å¤„ç†ä¸ä¸€è‡´

3. **æµ‹è¯•é—®é¢˜**
   - ç¼ºä¹é›†æˆæµ‹è¯•
   - å›æµ‹ç»“æœéªŒè¯ä¸è¶³
   - å®ç›˜æµ‹è¯•ç¯å¢ƒå—é™

## 3. è¿ç§»ç­–ç•¥

### 3.1 æ€»ä½“åŸåˆ™

1. **æ¸è¿›å¼è¿ç§»**ï¼šåˆ†é˜¶æ®µå®æ–½ï¼Œæ¯ä¸ªé˜¶æ®µå¯ç‹¬ç«‹éªŒè¯
2. **å‘åå…¼å®¹**ï¼šä¿æŒç°æœ‰APIç¨³å®šï¼Œæä¾›è¿ç§»è„šæœ¬
3. **å¹¶è¡Œè¿è¡Œ**ï¼šæ–°æ—§ç³»ç»Ÿå¹¶è¡Œè¿è¡Œï¼Œå¯¹æ¯”ç»“æœ
4. **å¯å›æ»š**ï¼šæ¯ä¸ªé˜¶æ®µéƒ½æœ‰å›æ»šæ–¹æ¡ˆ

### 3.2 è¿ç§»æ¨¡å¼

```
æ–°æ¶æ„ç»„ä»¶ â”€â”€â”¬â”€â”€> æ–°ç³»ç»Ÿï¼ˆé€æ­¥è¿ç§»ï¼‰
            â”‚
ç°æœ‰ç³»ç»Ÿ â”€â”€â”€â”´â”€â”€> å…¼å®¹å±‚ â”€â”€> æ–°ç³»ç»Ÿ
```

## 4. åˆ†é˜¶æ®µå®æ–½è®¡åˆ’

### 4.1 ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€è®¾æ–½å‡†å¤‡ï¼ˆ2-3å‘¨ï¼‰

**ç›®æ ‡**ï¼šå»ºç«‹ç»Ÿä¸€äº‹ä»¶å¼•æ“å’ŒåŸºç¡€æ¶æ„

#### 4.1.1 ä»»åŠ¡æ¸…å•

| ä»»åŠ¡ | æè¿° | ä¼˜å…ˆçº§ | é¢„ä¼°å·¥æ—¶ |
|------|------|--------|----------|
| æ‰©å±•äº‹ä»¶å¼•æ“ | å¢å¼ºç°æœ‰EventEngineï¼Œæ”¯æŒä¼˜å…ˆçº§å’Œå†å²è®°å½• | é«˜ | 3å¤© |
| åˆ›å»ºäº‹ä»¶ç±»å‹ | å®šä¹‰å¸‚åœº/ç­–ç•¥/è®¢å•/ç³»ç»Ÿäº‹ä»¶ç±»å‹ | é«˜ | 2å¤© |
| å®ç°çŠ¶æ€æœºåŸºç±» | åˆ›å»ºOrderStateMachineå’ŒStrategyStateMachine | é«˜ | 2å¤© |
| è®¾è®¡é…ç½®ç³»ç»Ÿ | ç»Ÿä¸€é…ç½®ç»“æ„ï¼Œæ”¯æŒæ¨¡å¼åˆ‡æ¢ | ä¸­ | 2å¤© |
| åˆ›å»ºåŸºç¡€æµ‹è¯• | äº‹ä»¶å¼•æ“å’ŒçŠ¶æ€æœºå•å…ƒæµ‹è¯• | é«˜ | 3å¤© |

#### 4.1.2 äº¤ä»˜ç‰©

- `src/core/events/` - äº‹ä»¶ç±»å‹å®šä¹‰
- `src/core/state_machine.py` - çŠ¶æ€æœºåŸºç±»
- `src/config/unified_config.py` - ç»Ÿä¸€é…ç½®
- äº‹ä»¶å¼•æ“æµ‹è¯•ç”¨ä¾‹ï¼ˆè¦†ç›–ç‡>80%ï¼‰

#### 4.1.3 éªŒæ”¶æ ‡å‡†

- [ ] äº‹ä»¶å¼•æ“æ”¯æŒä¼˜å…ˆçº§é˜Ÿåˆ—
- [ ] äº‹ä»¶å†å²è®°å½•åŠŸèƒ½æ­£å¸¸
- [ ] çŠ¶æ€æœºçŠ¶æ€è½¬ç§»æ­£ç¡®
- [ ] æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡

### 4.2 ç¬¬äºŒé˜¶æ®µï¼šæ•°æ®å±‚é‡æ„ï¼ˆ2-3å‘¨ï¼‰

**ç›®æ ‡**ï¼šç»Ÿä¸€æ•°æ®è®¿é—®æ¥å£ï¼Œéš”ç¦»å†å²å’Œå®æ—¶æ•°æ®

#### 4.2.1 ä»»åŠ¡æ¸…å•

| ä»»åŠ¡ | æè¿° | ä¼˜å…ˆçº§ | é¢„ä¼°å·¥æ—¶ |
|------|------|--------|----------|
| åˆ›å»ºDataAdapteræ¥å£ | å®šä¹‰ç»Ÿä¸€æ•°æ®è®¿é—®æ¥å£ | é«˜ | 2å¤© |
| å®ç°HistoricalAdapter | å†å²æ•°æ®é€‚é…å™¨ | é«˜ | 3å¤© |
| å®ç°LiveAdapter | å®æ—¶æ•°æ®é€‚é…å™¨ | ä¸­ | 3å¤© |
| å®ç°å‰è§†åå·®æ£€æµ‹å™¨ | LookaheadChecker | é«˜ | 2å¤© |
| å®ç°æ•°æ®ç¼“å­˜ç³»ç»Ÿ | å¤šçº§ç¼“å­˜æœºåˆ¶ | ä¸­ | 2å¤© |
| è¿ç§»ç°æœ‰æ•°æ®åŠ è½½ | é‡æ„data/manager.py | é«˜ | 3å¤© |

#### 4.2.2 äº¤ä»˜ç‰©

- `src/data/adapter/` - æ•°æ®é€‚é…å™¨
- `src/data/cache/` - ç¼“å­˜ç³»ç»Ÿ
- `src/data/lookahead.py` - å‰è§†åå·®æ£€æµ‹
- æ•°æ®å±‚æµ‹è¯•ç”¨ä¾‹

#### 4.2.3 éªŒæ”¶æ ‡å‡†

- [ ] HistoricalAdapterè¿”å›çš„æ•°æ®æ ¼å¼ä¸LiveAdapterä¸€è‡´
- [ ] å‰è§†åå·®æ£€æµ‹å™¨èƒ½å¤Ÿè¯†åˆ«å¸¸è§é—®é¢˜
- [ ] ç¼“å­˜å‘½ä¸­ç‡>50%
- [ ] ç°æœ‰å›æµ‹åŠŸèƒ½ä¸å—å½±å“

### 4.3 ç¬¬ä¸‰é˜¶æ®µï¼šç­–ç•¥æ¥å£ç»Ÿä¸€ï¼ˆ3-4å‘¨ï¼‰

**ç›®æ ‡**ï¼šç»Ÿä¸€ç­–ç•¥æ¥å£ï¼Œå…¼å®¹ç°æœ‰ç­–ç•¥

#### 4.3.1 ä»»åŠ¡æ¸…å•

| ä»»åŠ¡ | æè¿° | ä¼˜å…ˆçº§ | é¢„ä¼°å·¥æ—¶ |
|------|------|--------|----------|
| è®¾è®¡ç»Ÿä¸€ç­–ç•¥æ¥å£ | UnifiedStrategyåŸºç±»è®¾è®¡ | é«˜ | 2å¤© |
| å®ç°ç­–ç•¥é€‚é…å™¨ | ç°æœ‰ç­–ç•¥åˆ°æ–°æ¥å£çš„é€‚é…å™¨ | é«˜ | 3å¤© |
| è¿ç§»ç°æœ‰ç­–ç•¥ | è¿ç§»3-5ä¸ªæ ¸å¿ƒç­–ç•¥ | é«˜ | 5å¤© |
| å®ç°ç­–ç•¥ç®¡ç†å™¨ | StrategyManagerç»„ä»¶ | ä¸­ | 3å¤© |
| æ›´æ–°ç­–ç•¥æ³¨å†Œ | ä¿æŒè‡ªåŠ¨æ³¨å†Œæœºåˆ¶ | ä¸­ | 2å¤© |

#### 4.3.2 ç­–ç•¥æ¥å£è®¾è®¡

```python
class UnifiedStrategy(ABC):
    """ç»Ÿä¸€ç­–ç•¥æ¥å£"""
    
    # æ•°æ®å‡†å¤‡ï¼ˆå‘é‡åŒ–ï¼‰
    async def prepare_data(self, data_adapter: DataAdapter, 
                          context: StrategyContext) -> Dict[str, pd.DataFrame]:
        """å‡†å¤‡ç­–ç•¥æ‰€éœ€æ•°æ®"""
        pass
    
    # äº‹ä»¶å¤„ç†ï¼ˆäº‹ä»¶é©±åŠ¨ï¼‰
    async def on_market_event(self, event: MarketEvent, 
                             context: StrategyContext) -> List[Signal]:
        """å¤„ç†å¸‚åœºäº‹ä»¶"""
        pass
    
    async def on_signal_event(self, event: SignalEvent,
                             context: StrategyContext) -> List[OrderIntent]:
        """å¤„ç†ä¿¡å·äº‹ä»¶"""
        pass
    
    # ç”Ÿå‘½å‘¨æœŸ
    async def on_start(self, context: StrategyContext):
        """ç­–ç•¥å¯åŠ¨"""
        pass
    
    async def on_stop(self, context: StrategyContext):
        """ç­–ç•¥åœæ­¢"""
        pass
```

#### 4.3.3 äº¤ä»˜ç‰©

- `src/strategies/base/unified_strategy.py` - ç»Ÿä¸€ç­–ç•¥æ¥å£
- `src/strategies/base/strategy_adapter.py` - ç­–ç•¥é€‚é…å™¨
- è¿ç§»åçš„ç­–ç•¥ç¤ºä¾‹
- ç­–ç•¥å±‚æµ‹è¯•ç”¨ä¾‹

#### 4.3.4 éªŒæ”¶æ ‡å‡†

- [ ] ç°æœ‰ç­–ç•¥é€šè¿‡é€‚é…å™¨å¯ä»¥æ­£å¸¸å·¥ä½œ
- [ ] æ–°æ¥å£æ”¯æŒå‘é‡åŒ–é¢„è®¡ç®—
- [ ] æ–°æ¥å£æ”¯æŒäº‹ä»¶é©±åŠ¨å¤„ç†
- [ ] å›æµ‹ç»“æœä¸è¿ç§»å‰ä¸€è‡´

### 4.4 ç¬¬å››é˜¶æ®µï¼šæ‰§è¡Œå¼•æ“é‡æ„ï¼ˆ3-4å‘¨ï¼‰

**ç›®æ ‡**ï¼šç»Ÿä¸€è®¢å•ç®¡ç†ï¼Œå®ç°å®Œæ•´çš„çŠ¶æ€æœº

#### 4.4.1 ä»»åŠ¡æ¸…å•

| ä»»åŠ¡ | æè¿° | ä¼˜å…ˆçº§ | é¢„ä¼°å·¥æ—¶ |
|------|------|--------|----------|
| å®ç°OrderManager | è®¢å•ç®¡ç†å™¨ç»„ä»¶ | é«˜ | 3å¤© |
| å®ç°ExecutionManager | æ‰§è¡Œç®¡ç†å™¨ç»„ä»¶ | é«˜ | 3å¤© |
| å®Œå–„SimulatedExecutor | æ¨¡æ‹Ÿæ‰§è¡Œå™¨é‡æ„ | é«˜ | 3å¤© |
| é›†æˆIBBroker | IBBrokeré€‚é…åˆ°æ–°æ‰§è¡Œå¼•æ“ | ä¸­ | 3å¤© |
| å®ç°æˆæœ¬æ¨¡å‹ | ç»Ÿä¸€æˆæœ¬è®¡ç®— | ä¸­ | 2å¤© |

#### 4.4.2 è®¢å•çŠ¶æ€æœºè®¾è®¡

```
CREATED â†’ VALIDATING â†’ VALIDATED â†’ PENDING_SUBMIT â†’ SUBMITTING â†’ SUBMITTED
                      â†“                                            â†“
                 REJECTED                                PARTIALLY_FILLED
                                                                â†“
                                                           FILLED (ç»ˆæ€)
                                             
                                        PENDING_CANCEL â†’ CANCELLING â†’ CANCELLED (ç»ˆæ€)
                                        â†“
                              å¯èƒ½åœ¨å–æ¶ˆè¿‡ç¨‹ä¸­æˆäº¤ â†’ FILLED
```

#### 4.4.3 äº¤ä»˜ç‰©

- `src/execution/order_manager.py` - è®¢å•ç®¡ç†å™¨
- `src/execution/execution_manager.py` - æ‰§è¡Œç®¡ç†å™¨
- `src/execution/broker/adapter.py` - åˆ¸å•†é€‚é…å™¨
- æ‰§è¡Œå±‚æµ‹è¯•ç”¨ä¾‹

#### 4.4.4 éªŒæ”¶æ ‡å‡†

- [ ] è®¢å•çŠ¶æ€è½¬ç§»æ­£ç¡®
- [ ] å›æµ‹æ‰§è¡Œä¸å®ç›˜æ‰§è¡Œä½¿ç”¨ç›¸åŒçš„è®¢å•ç®¡ç†
- [ ] æˆæœ¬è®¡ç®—ç»“æœä¸€è‡´
- [ ] è®¢å•æ—¥å¿—å®Œæ•´å¯è¿½æº¯

### 4.5 ç¬¬äº”é˜¶æ®µï¼šå›æµ‹å¼•æ“é›†æˆï¼ˆ3-4å‘¨ï¼‰

**ç›®æ ‡**ï¼šåŸºäºæ–°æ¶æ„é‡æ„å›æµ‹å¼•æ“

#### 4.5.1 ä»»åŠ¡æ¸…å•

| ä»»åŠ¡ | æè¿° | ä¼˜å…ˆçº§ | é¢„ä¼°å·¥æ—¶ |
|------|------|--------|----------|
| è®¾è®¡å›æµ‹äº‹ä»¶æµç¨‹ | å®šä¹‰å›æµ‹ä¸“ç”¨äº‹ä»¶æµ | é«˜ | 2å¤© |
| å®ç°æ—¶é—´è½´ç”Ÿæˆå™¨ | TimeAxisGenerator | é«˜ | 2å¤© |
| é›†æˆæ–°ç­–ç•¥å¼•æ“ | StrategyExecutoråˆ°å›æµ‹ | é«˜ | 3å¤© |
| é›†æˆæ–°æ‰§è¡Œå¼•æ“ | æ‰§è¡Œå¼•æ“åˆ°å›æµ‹ | é«˜ | 3å¤© |
| è¿ç§»é£æ§æ¨¡å— | RiskManageré›†æˆ | ä¸­ | 2å¤© |
| ç»“æœéªŒè¯ | å›æµ‹ç»“æœå¯¹æ¯”éªŒè¯ | é«˜ | 3å¤© |

#### 4.5.2 å›æµ‹äº‹ä»¶æµç¨‹è®¾è®¡

```mermaid
sequenceDiagram
    participant T as TimeAxisGenerator
    participant E as EventEngine
    participant S as StrategyExecutor
    participant O as OrderManager
    participant F as FillsProcessor
    
    T->>E: å‘å¸ƒMarketEvent(ts1)
    E->>S: MarketEvent
    S->>E: SignalEvent
    E->>O: OrderCreatedEvent
    O->>E: OrderValidatedEvent
    E->>F: OrderFilledEvent
    F->>E: PortfolioUpdatedEvent
    E->>T: å®Œæˆå¤„ç†
```

#### 4.5.3 äº¤ä»˜ç‰©

- `src/evaluation/backtesting/event_engine.py` - å›æµ‹äº‹ä»¶å¼•æ“
- `src/evaluation/backtesting/time_axis.py` - æ—¶é—´è½´ç”Ÿæˆå™¨
- é‡æ„åçš„`src/evaluation/backtesting/engine.py`
- å›æµ‹é›†æˆæµ‹è¯•

#### 4.5.4 éªŒæ”¶æ ‡å‡†

- [ ] å›æµ‹ç»“æœä¸åŸç³»ç»Ÿä¸€è‡´ï¼ˆè¯¯å·®<0.1%ï¼‰
- [ ] æ”¯æŒä¸‰ç§æ—¶é’Ÿæ¨¡å¼ï¼ˆdaily/bar/hybridï¼‰
- [ ] å‰è§†åå·®æ£€æµ‹æ­£å¸¸å·¥ä½œ
- [ ] æ€§èƒ½ä¸‹é™<20%

### 4.6 ç¬¬å…­é˜¶æ®µï¼šå®ç›˜å¼•æ“é›†æˆï¼ˆ3-4å‘¨ï¼‰

**ç›®æ ‡**ï¼šå°†å®ç›˜äº¤æ˜“æ¥å…¥ç»Ÿä¸€æ¶æ„

#### 4.6.1 ä»»åŠ¡æ¸…å•

| ä»»åŠ¡ | æè¿° | ä¼˜å…ˆçº§ | é¢„ä¼°å·¥æ—¶ |
|------|------|--------|----------|
| å®ç°å®æ—¶äº‹ä»¶é€‚é…å™¨ | å®æ—¶æ•°æ®åˆ°äº‹ä»¶çš„è½¬æ¢ | é«˜ | 2å¤© |
| é›†æˆIBäº‹ä»¶æµ | IBBrokeräº‹ä»¶é›†æˆ | é«˜ | 3å¤© |
| å®ç°è¿æ¥ç®¡ç† | è¿æ¥çŠ¶æ€ç®¡ç† | ä¸­ | 2å¤© |
| å®ç°é”™è¯¯æ¢å¤ | æ–­çº¿é‡è¿ç­‰ | ä¸­ | 3å¤© |
| å®ç›˜æµ‹è¯• | æ¨¡æ‹Ÿå®ç›˜ç¯å¢ƒæµ‹è¯• | é«˜ | 4å¤© |

#### 4.6.2 äº¤ä»˜ç‰©

- `src/execution/broker/ib_adapter.py` - IBé€‚é…å™¨
- `src/execution/broker/live_events.py` - å®æ—¶äº‹ä»¶å¤„ç†
- `src/execution/recovery.py` - é”™è¯¯æ¢å¤æœºåˆ¶
- å®ç›˜æµ‹è¯•æŠ¥å‘Š

#### 4.6.3 éªŒæ”¶æ ‡å‡†

- [ ] å®ç›˜è®¢å•æµç¨‹ä¸å›æµ‹ä¸€è‡´
- [ ] æ–­çº¿é‡è¿æ­£å¸¸å·¥ä½œ
- [ ] çŠ¶æ€æ¢å¤æ­£ç¡®
- [ ] æ€§èƒ½æ»¡è¶³è¦æ±‚

### 4.7 ç¬¬ä¸ƒé˜¶æ®µï¼šä¼˜åŒ–å’Œç¨³å®šï¼ˆ2-3å‘¨ï¼‰

**ç›®æ ‡**ï¼šæ€§èƒ½ä¼˜åŒ–å’Œé—®é¢˜ä¿®å¤

#### 4.7.1 ä»»åŠ¡æ¸…å•

| ä»»åŠ¡ | æè¿° | ä¼˜å…ˆçº§ | é¢„ä¼°å·¥æ—¶ |
|------|------|--------|----------|
| æ€§èƒ½ä¼˜åŒ– | çƒ­ç‚¹ä»£ç ä¼˜åŒ– | ä¸­ | 3å¤© |
| æ—¥å¿—å®Œå–„ | ç»Ÿä¸€æ—¥å¿—æ ¼å¼ | ä¸­ | 2å¤© |
| ç›‘æ§é›†æˆ | æŒ‡æ ‡æ”¶é›†å’Œå±•ç¤º | ä¸­ | 3å¤© |
| æ–‡æ¡£æ›´æ–° | å¼€å‘è€…æ–‡æ¡£ | ä¸­ | 2å¤© |
| Bugä¿®å¤ | å·²çŸ¥é—®é¢˜ä¿®å¤ | é«˜ | 3å¤© |

## 5. è¯¦ç»†æ—¶é—´çº¿ä¸å½“å‰è¿›åº¦

```
å‘¨æ¬¡  | é˜¶æ®µ                    | é‡Œç¨‹ç¢‘                          | å½“å‰çŠ¶æ€
-----|------------------------|---------------------------------|------------------
1-2  | ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€è®¾æ–½      | äº‹ä»¶å¼•æ“å°±ç»ª                    | âœ… å®Œæˆ (100%)
3-4  | ç¬¬äºŒé˜¶æ®µï¼šæ•°æ®å±‚        | DataAdapterå°±ç»ª                 | âœ… å®Œæˆ (100%)
5-7  | ç¬¬ä¸‰é˜¶æ®µï¼šç­–ç•¥æ¥å£      | ç­–ç•¥é€‚é…å®Œæˆ                    | âœ… å®Œæˆ (100%)
8-10 | ç¬¬å››é˜¶æ®µï¼šæ‰§è¡Œå¼•æ“      | OrderManagerå°±ç»ª                | âœ… å®Œæˆ (100%)
11-14| ç¬¬äº”é˜¶æ®µï¼šå›æµ‹é›†æˆ      | å›æµ‹é‡æ„å®Œæˆ                    | âœ… å®Œæˆ (90%)
15-18| ç¬¬å…­é˜¶æ®µï¼šå®ç›˜é›†æˆ      | å®ç›˜å¯¹æ¥å®Œæˆ                    | âš ï¸ è¿›è¡Œä¸­ (50%)
19-21| ç¬¬ä¸ƒé˜¶æ®µï¼šä¼˜åŒ–ç¨³å®š      | ç³»ç»Ÿç¨³å®šå‘å¸ƒ                    | â³ æœªå¯åŠ¨ (0%)
```

### å½“å‰è¿›åº¦æ€»ç»“ (æˆªè‡³ 2026-01-13)

**æ€»ä½“è¿›åº¦ï¼š~80%**

**å·²å®Œæˆçš„æ ¸å¿ƒç»„ä»¶ï¼š**
- âœ… [`UnifiedEventEngine`](src/core/events/engine.py:63) - ä¼˜å…ˆçº§é˜Ÿåˆ—ã€äº‹ä»¶å†å²ã€è®¢é˜…æœºåˆ¶
- âœ… [`OrderStateMachine`](src/core/state_machine.py:155) - 11ä¸ªçŠ¶æ€çš„è®¢å•çŠ¶æ€æœº
- âœ… [`DataAdapter`](src/data/adapter/__init__.py:59) + [`HistoricalDataAdapter`](src/data/adapter/__init__.py:174) + [`LiveDataAdapter`](src/data/adapter/__init__.py:376)
- âœ… [`UnifiedStrategy`](src/strategies/base/unified_strategy.py:43) - ç»Ÿä¸€ç­–ç•¥æ¥å£
- âœ… [`OrderManager`](src/execution/order_manager.py:70) - è®¢å•ç”Ÿå‘½å‘¨æœŸç®¡ç†
- âœ… [`BacktestEventEngine`](src/evaluation/backtesting/event_engine.py:71) - å›æµ‹äº‹ä»¶å¼•æ“

**ç¬¬äº”é˜¶æ®µæœ€æ–°è¿›å±•ï¼š**
- âœ… [`_on_order_created_event`](src/evaluation/backtesting/event_engine.py:185) é›†æˆå®Œæˆ - è®¢å•æäº¤åˆ°æ‰§è¡Œå¼•æ“
- âœ… å›æµ‹ç»“æœéªŒè¯å¢å¼º - æ·»åŠ äº†å®Œæ•´æŒ‡æ ‡è®¡ç®—ï¼ˆæ€»æ”¶ç›Šã€å¹´åŒ–æ”¶ç›Šã€æœ€å¤§å›æ’¤ã€å¤æ™®æ¯”ç‡ã€èƒœç‡ï¼‰
- âœ… æ€§èƒ½æµ‹è¯•å·¥å…·åˆ›å»º - [`tests/performance/test_backtest_performance.py`](tests/performance/test_backtest_performance.py)
- âœ… çƒ­ç‚¹ä»£ç ä¼˜åŒ– - EventHandler coroutineæ£€æŸ¥ç¼“å­˜ã€dequeæ›¿ä»£Listã€ç­–ç•¥æŸ¥æ‰¾O(1)

**ç¬¬å…­é˜¶æ®µæœ€æ–°è¿›å±•ï¼š**
- âœ… IBé€‚é…å™¨åŸºç¡€ç»“æ„ - [`IBBrokerExecutor`](src/execution/broker/ib_broker_adapter.py:20)
- âœ… è¿æ¥ç®¡ç†å™¨ - [`ConnectionManager`](src/execution/broker/ib_broker_adapter.py:252)
- âœ… é”™è¯¯æ¢å¤æœºåˆ¶ - [`ErrorRecovery`](src/execution/broker/ib_broker_adapter.py:328)
- âš ï¸ ç«¯åˆ°ç«¯æµ‹è¯•åˆ›å»º - [`tests/e2e/test_live_integration.py`](tests/e2e/test_live_integration.py)

**å¾…å®Œæˆé¡¹ï¼š**
- ğŸ”„ å›æµ‹æ€§èƒ½æµ‹è¯•è¿è¡ŒéªŒè¯
- âš ï¸ IBå®ç›˜è¿æ¥å®é™…æµ‹è¯•
- â³ ç³»ç»Ÿä¼˜åŒ–å’Œæ–‡æ¡£æ›´æ–°

## 6. èµ„æºéœ€æ±‚

### 6.1 å¼€å‘èµ„æº

| è§’è‰² | äººæ•° | æŠ•å…¥æ¯”ä¾‹ |
|------|------|----------|
| é«˜çº§å¼€å‘ | 1 | 100% |
| ä¸­çº§å¼€å‘ | 1-2 | 100% |
| æµ‹è¯• | 1 | 50% |

### 6.2 æŠ€æœ¯åŸºç¡€è®¾æ–½

- å¼€å‘ç¯å¢ƒï¼šmacOS/Linux + Python 3.10+
- æµ‹è¯•ç¯å¢ƒï¼šç‹¬ç«‹å›æµ‹éªŒè¯ç¯å¢ƒ
- ç›‘æ§å·¥å…·ï¼šç°æœ‰ç›‘æ§ç³»ç»Ÿ
- CI/CDï¼šç°æœ‰GitHub Actions

## 7. é£é™©è¯„ä¼°

### 7.1 æŠ€æœ¯é£é™©

| é£é™© | å¯èƒ½æ€§ | å½±å“ | ç¼“è§£æªæ–½ |
|------|--------|------|----------|
| å›æµ‹ç»“æœä¸ä¸€è‡´ | ä¸­ | é«˜ | å…¨é¢å¯¹æ¯”æµ‹è¯•ï¼Œå¹¶è¡Œè¿è¡Œ |
| æ€§èƒ½ä¸‹é™ | ä¸­ | ä¸­ | æ€§èƒ½æµ‹è¯•ï¼Œä¼˜åŒ–çƒ­ç‚¹ä»£ç  |
| ç­–ç•¥å…¼å®¹æ€§é—®é¢˜ | ä½ | é«˜ | é€‚é…å™¨æ¨¡å¼ï¼Œé€æ­¥è¿ç§» |
| å®ç›˜ç¨³å®šæ€§é—®é¢˜ | ä¸­ | é«˜ | å……åˆ†æµ‹è¯•ï¼Œç›‘æ§å‘Šè­¦ |

### 7.2 è¿›åº¦é£é™©

| é£é™© | å¯èƒ½æ€§ | å½±å“ | ç¼“è§£æªæ–½ |
|------|--------|------|----------|
| éœ€æ±‚å˜æ›´ | ä¸­ | ä¸­ | æ•æ·å¼€å‘ï¼Œå¿«é€Ÿå“åº” |
| æŠ€æœ¯éš¾ç‚¹ | ä¸­ | ä¸­ | é¢„ç•™ç¼“å†²æ—¶é—´ï¼ŒæŠ€æœ¯é¢„ç ” |
| èµ„æºä¸è¶³ | ä½ | é«˜ | æå‰è§„åˆ’ï¼Œå¤‡é€‰æ–¹æ¡ˆ |

## 8. è´¨é‡ä¿è¯

### 8.1 æµ‹è¯•ç­–ç•¥

1. **å•å…ƒæµ‹è¯•**
   - äº‹ä»¶å¼•æ“æµ‹è¯•ï¼ˆè¦†ç›–ç‡>90%ï¼‰
   - çŠ¶æ€æœºæµ‹è¯•ï¼ˆè¦†ç›–ç‡>90%ï¼‰
   - æ•°æ®é€‚é…å™¨æµ‹è¯•ï¼ˆè¦†ç›–ç‡>80%ï¼‰

2. **é›†æˆæµ‹è¯•**
   - å›æµ‹æµç¨‹æµ‹è¯•
   - å®ç›˜æµç¨‹æµ‹è¯•
   - å¼‚å¸¸åœºæ™¯æµ‹è¯•

3. **å›å½’æµ‹è¯•**
   - ç°æœ‰ç­–ç•¥å›æµ‹ç»“æœå¯¹æ¯”
   - æ€§èƒ½åŸºå‡†æµ‹è¯•
   - å‹åŠ›æµ‹è¯•

### 8.2 éªŒæ”¶æ ‡å‡†

- [ ] æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡
- [ ] å›æµ‹ç»“æœä¸åŸç³»ç»Ÿä¸€è‡´
- [ ] æ€§èƒ½ä¸‹é™<20%
- [ ] ä»£ç è¦†ç›–ç‡>80%
- [ ] æ–‡æ¡£å®Œæ•´

## 9. æ²Ÿé€šè®¡åˆ’

### 9.1 å®šæœŸä¼šè®®

- æ¯æ—¥ç«™ä¼šï¼ˆ15åˆ†é’Ÿï¼‰
- æ¯å‘¨è¿›åº¦æ±‡æŠ¥
- é˜¶æ®µè¯„å®¡ä¼šè®®

### 9.2 æ–‡æ¡£æ›´æ–°

- è®¾è®¡æ–‡æ¡£æ›´æ–°ï¼ˆæ¯ä¸ªé˜¶æ®µï¼‰
- APIæ–‡æ¡£æ›´æ–°ï¼ˆæ¯ä¸ªé˜¶æ®µï¼‰
- ç”¨æˆ·æŒ‡å—æ›´æ–°ï¼ˆæœ€ç»ˆé˜¶æ®µï¼‰

## 10. åç»­è§„åˆ’

### 10.1 çŸ­æœŸä¼˜åŒ–ï¼ˆå®Œæˆå1-2ä¸ªæœˆï¼‰

- æ€§èƒ½è°ƒä¼˜
- Bugä¿®å¤
- ç”¨æˆ·åé¦ˆå¤„ç†

### 10.2 ä¸­æœŸæ‰©å±•ï¼ˆå®Œæˆå3-6ä¸ªæœˆï¼‰

- å¤šå¸‚åœºæ”¯æŒ
- é«˜çº§ç­–ç•¥åŠŸèƒ½
- ä¼˜åŒ–å™¨å¢å¼º

### 10.3 é•¿æœŸè§„åˆ’ï¼ˆå®Œæˆå6-12ä¸ªæœˆï¼‰

- æœºå™¨å­¦ä¹ é›†æˆ
- äº‘åŸç”Ÿéƒ¨ç½²
- é«˜çº§åˆ†æåŠŸèƒ½

## 11. é™„å½•

### 11.1 å…³é”®æ–‡ä»¶æ¸…å•

```
src/core/
â”œâ”€â”€ events/          # äº‹ä»¶ç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base.py      # EventåŸºç±»
â”‚   â”œâ”€â”€ market.py    # å¸‚åœºäº‹ä»¶
â”‚   â”œâ”€â”€ strategy.py  # ç­–ç•¥äº‹ä»¶
â”‚   â”œâ”€â”€ order.py     # è®¢å•äº‹ä»¶
â”‚   â””â”€â”€ system.py    # ç³»ç»Ÿäº‹ä»¶
â”œâ”€â”€ state_machine.py # çŠ¶æ€æœºåŸºç±»
â””â”€â”€ context.py       # ä¸Šä¸‹æ–‡å®šä¹‰

src/data/
â”œâ”€â”€ adapter/         # æ•°æ®é€‚é…å™¨
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base.py      # DataAdapteråŸºç±»
â”‚   â”œâ”€â”€ historical.py # HistoricalDataAdapter
â”‚   â””â”€â”€ live.py      # LiveDataAdapter
â”œâ”€â”€ cache/           # ç¼“å­˜ç³»ç»Ÿ
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ memory.py
â”‚   â””â”€â”€ disk.py
â””â”€â”€ lookahead.py     # å‰è§†åå·®æ£€æµ‹

src/strategies/
â”œâ”€â”€ base/
â”‚   â”œâ”€â”€ unified_strategy.py  # ç»Ÿä¸€ç­–ç•¥æ¥å£
â”‚   â””â”€â”€ strategy_adapter.py  # ç­–ç•¥é€‚é…å™¨
â””â”€â”€ ...

src/execution/
â”œâ”€â”€ order_manager.py      # è®¢å•ç®¡ç†å™¨
â”œâ”€â”€ execution_manager.py  # æ‰§è¡Œç®¡ç†å™¨
â””â”€â”€ broker/
    â”œâ”€â”€ adapter.py        # åˆ¸å•†é€‚é…å™¨
    â””â”€â”€ ib_adapter.py     # IBé€‚é…å™¨

src/evaluation/backtesting/
â”œâ”€â”€ event_engine.py   # å›æµ‹äº‹ä»¶å¼•æ“
â”œâ”€â”€ time_axis.py      # æ—¶é—´è½´ç”Ÿæˆå™¨
â””â”€â”€ engine.py         # é‡æ„åçš„å›æµ‹å¼•æ“
```

### 11.2 é…ç½®ç¤ºä¾‹

```yaml
# unified_config.yaml
mode: "backtest"  # "backtest" æˆ– "live"

data:
  source: "historical"  # "historical" æˆ– "live"
  adapter:
    cache_size: 1000
    cache_ttl: 3600
  historical:
    storage_type: "parquet"
    data_dir: "data/parquet"
  live:
    reconnect_delay: 5
    heartbeat_interval: 30

strategies:
  - id: "simple_momentum"
    class: "src.strategies.example.simple_momentum:SimpleMomentumStrategy"
    params:
      lookback_period: 20
      threshold: 0.0

execution:
  mode: "simulated"  # "simulated" æˆ– "live"
  simulated:
    commission_rate: 0.001
    slippage_rate: 0.0005
  live:
    broker: "ib"
    host: "127.0.0.1"
    port: 7497
    client_id: 1

risk:
  max_position_size: 0.2
  max_positions: 10
  daily_loss_limit: 0.05

clock:
  mode: "hybrid"  # "daily", "bar", æˆ– "hybrid"
  signal_timeframe: "1d"
  execution_timeframe: "1d"
  execution_time: "16:00:00"
```

### 11.3 è¿ç§»æ£€æŸ¥æ¸…å•

**ç¬¬ä¸€é˜¶æ®µæ£€æŸ¥æ¸…å•**
- [ ] äº‹ä»¶å¼•æ“æ”¯æŒä¼˜å…ˆçº§
- [ ] äº‹ä»¶å†å²è®°å½•åŠŸèƒ½
- [ ] OrderStateMachineå®ç°
- [ ] StrategyStateMachineå®ç°
- [ ] äº‹ä»¶å•å…ƒæµ‹è¯•>80%è¦†ç›–

**ç¬¬äºŒé˜¶æ®µæ£€æŸ¥æ¸…å•**
- [ ] DataAdapteræ¥å£å®šä¹‰
- [ ] HistoricalDataAdapterå®ç°
- [ ] LiveDataAdapterå®ç°
- [ ] LookaheadCheckerå®ç°
- [ ] æ•°æ®ç¼“å­˜å·¥ä½œæ­£å¸¸

**ç¬¬ä¸‰é˜¶æ®µæ£€æŸ¥æ¸…å•**
- [ ] UnifiedStrategyæ¥å£å®šä¹‰
- [ ] StrategyAdapterå®ç°
- [ ] è‡³å°‘3ä¸ªç­–ç•¥è¿ç§»å®Œæˆ
- [ ] ç­–ç•¥æµ‹è¯•é€šè¿‡
- [ ] ç­–ç•¥æ³¨å†Œæœºåˆ¶ä¿ç•™

**ç¬¬å››é˜¶æ®µæ£€æŸ¥æ¸…å•**
- [ ] OrderManagerå®ç°
- [ ] ExecutionManagerå®ç°
- [ ] SimulatedExecutoré‡æ„
- [ ] IBBrokeré€‚é…
- [ ] è®¢å•çŠ¶æ€æœºå®Œæ•´

**ç¬¬äº”é˜¶æ®µæ£€æŸ¥æ¸…å•**
- [x] å›æµ‹äº‹ä»¶å¼•æ“å°±ç»ª - [`BacktestEventEngine`](src/evaluation/backtesting/event_engine.py:71)
- [x] æ—¶é—´è½´ç”Ÿæˆå™¨å®ç° - `_generate_timeline` æ–¹æ³•
- [x] å›æµ‹æµç¨‹é›†æˆ - bar â†’ signal â†’ order äº‹ä»¶é“¾
- [x] å›æµ‹ç»“æœå¯¹æ¯”éªŒè¯ - æ·»åŠ äº†å®Œæ•´æŒ‡æ ‡è®¡ç®—ï¼ˆæ€»æ”¶ç›Šã€å¹´åŒ–æ”¶ç›Šã€æœ€å¤§å›æ’¤ã€å¤æ™®æ¯”ç‡ã€èƒœç‡ï¼‰
- [x] æ€§èƒ½æµ‹è¯•å·¥å…·åˆ›å»º - [`tests/performance/test_backtest_performance.py`](tests/performance/test_backtest_performance.py)
- [x] çƒ­ç‚¹ä»£ç ä¼˜åŒ– - EventHandler coroutineæ£€æŸ¥ç¼“å­˜ã€dequeæ›¿ä»£Listã€ç­–ç•¥æŸ¥æ‰¾O(1)
- [ ] æ€§èƒ½æµ‹è¯•è¿è¡ŒéªŒè¯

**ç¬¬å…­é˜¶æ®µæ£€æŸ¥æ¸…å•**
- [x] IBé€‚é…å™¨åŸºç¡€ç»“æ„ - [`IBBrokerExecutor`](src/execution/broker/ib_broker_adapter.py:20)
- [x] è¿æ¥ç®¡ç†å™¨ - [`ConnectionManager`](src/execution/broker/ib_broker_adapter.py:252)
- [x] é”™è¯¯æ¢å¤æœºåˆ¶ - [`ErrorRecovery`](src/execution/broker/ib_broker_adapter.py:328)
- [x] ç«¯åˆ°ç«¯æµ‹è¯•åˆ›å»º - [`tests/e2e/test_live_integration.py`](tests/e2e/test_live_integration.py)
- [ ] IBå®ç›˜è¿æ¥å®é™…æµ‹è¯•
- [ ] è¿æ¥ç®¡ç†æµ‹è¯•
- [ ] é”™è¯¯æ¢å¤æµ‹è¯•

**ç¬¬ä¸ƒé˜¶æ®µæ£€æŸ¥æ¸…å•**
- [ ] æ€§èƒ½ä¼˜åŒ–å®Œæˆ
- [ ] æ—¥å¿—å®Œå–„
- [ ] ç›‘æ§é›†æˆ
- [ ] æ–‡æ¡£æ›´æ–°
- [ ] Bugä¿®å¤